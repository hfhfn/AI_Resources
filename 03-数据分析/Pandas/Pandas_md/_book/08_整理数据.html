<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>数据整理 | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-splitter/splitter.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-back-to-top-button/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-chapter-fold/chapter-fold.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-toc2/toc2.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-tbfed-pagefooter/footer.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./09_Pandas数据类型.html" />
    
    
    <link rel="prev" href="./07_缺失数据处理.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="3.3"
        data-chapter-title="数据整理"
        data-filepath="08_整理数据.md"
        data-basepath="."
        data-revision="Tue Apr 20 2021 11:46:25 GMT+0800 (中国标准时间)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="第1章-01-02_介绍及环境搭建.html">
            
                
                    <a href="./第1章-01-02_介绍及环境搭建.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Python数据分析介绍及环境搭建
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="01_Python数据分析简介.html">
            
                
                    <a href="./01_Python数据分析简介.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Python数据分析简介
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="02_Python数据分析开发环境搭建.html">
            
                
                    <a href="./02_Python数据分析开发环境搭建.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Python数据分析环境搭建
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="第2章-03-05_Pandas数据分析入门.html">
            
                
                    <a href="./第2章-03-05_Pandas数据分析入门.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Pandas数据分析入门
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="03_Pandas的DataFrame.html">
            
                
                    <a href="./03_Pandas的DataFrame.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Pandas的DataFrame
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="04_Pandas_数据结构.html">
            
                
                    <a href="./04_Pandas_数据结构.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Pandas_数据结构
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="05_Pandas数据分析入门.html">
            
                
                    <a href="./05_Pandas数据分析入门.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Pandas数据分析入门
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="第3章-06-09_Pandas数据清洗.html">
            
                
                    <a href="./第3章-06-09_Pandas数据清洗.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Pandas数据清洗
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="06_数据组合.html">
            
                
                    <a href="./06_数据组合.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        数据组合
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="07_缺失数据处理.html">
            
                
                    <a href="./07_缺失数据处理.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        缺失数据处理
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.3" data-path="08_整理数据.html">
            
                
                    <a href="./08_整理数据.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        数据整理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="09_Pandas数据类型.html">
            
                
                    <a href="./09_Pandas数据类型.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Pandas数据类型
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="第4章-10-13_Pandas数据处理.html">
            
                
                    <a href="./第4章-10-13_Pandas数据处理.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Pandas数据处理
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="10_Apply自定义函数.html">
            
                
                    <a href="./10_Apply自定义函数.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Apply自定义函数
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="11_数据分组.html">
            
                
                    <a href="./11_数据分组.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        数据分组
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="12_数据透视表.html">
            
                
                    <a href="./12_数据透视表.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        数据透视表
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="13_datetime数据类型.html">
            
                
                    <a href="./13_datetime数据类型.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        datetime数据类型
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="第5章-14-17_Python数据可视化.html">
            
                
                    <a href="./第5章-14-17_Python数据可视化.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Python数据可视化
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="14_Matplotlib绘图.html">
            
                
                    <a href="./14_Matplotlib绘图.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Matplotlib绘图
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="15_Pandas绘图.html">
            
                
                    <a href="./15_Pandas绘图.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Pandas绘图
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="16_Seaborn绘图.html">
            
                
                    <a href="./16_Seaborn绘图.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Seaborn绘图
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="17_Pyecharts绘图.html">
            
                
                    <a href="./17_Pyecharts绘图.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Pyecharts绘图
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="第6章-18-20_综合案例.html">
            
                
                    <a href="./第6章-18-20_综合案例.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        综合案例
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="18_综合案例_Appstore数据分析.html">
            
                
                    <a href="./18_综合案例_Appstore数据分析.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        综合案例_Appstore数据分析
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="19_综合案例_优衣库销售数据分析.html">
            
                
                    <a href="./19_综合案例_优衣库销售数据分析.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        综合案例_优衣库销售数据分析
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="20_综合案例_RFM用户分群.html">
            
                
                    <a href="./20_综合案例_RFM用户分群.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        综合案例_RFM用户分群
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="&#x6574;&#x7406;&#x6570;&#x636E;">&#x6574;&#x7406;&#x6570;&#x636E;</h1>
<h2 id="&#x5B66;&#x4E60;&#x76EE;&#x6807;">&#x5B66;&#x4E60;&#x76EE;&#x6807;</h2>
<ul>
<li>&#x638C;&#x63E1;melt&#x51FD;&#x6570;&#x6574;&#x7406;&#x6570;&#x636E;&#x7684;&#x65B9;&#x6CD5;</li>
<li>&#x638C;&#x63E1;stack&#x3001;unstack&#x7684;&#x7528;&#x6CD5;</li>
<li>&#x638C;&#x63E1;wide_to_long&#x51FD;&#x6570;&#x7684;&#x7528;&#x6CD5;</li>
</ul>
<h2 id="1-melt&#x6574;&#x7406;&#x6570;&#x636E;">1 melt&#x6574;&#x7406;&#x6570;&#x636E;</h2>
<ul>
<li>&#x4E0B;&#x9762;&#x52A0;&#x8F7D;&#x7F8E;&#x56FD;&#x6536;&#x5165;&#x4E0E;&#x5B97;&#x6559;&#x4FE1;&#x4EF0;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x79CD;&#x6570;&#x636E;&#x79F0;&#x4E3A;&#x201C;&#x5BBD;&#x201D;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
pew = pd.read_csv(<span class="hljs-string">&apos;data/pew.csv&apos;</span>)
pew.head()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">religion</th>
<th style="text-align:right">&lt;$10k</th>
<th style="text-align:right">$10-20k</th>
<th style="text-align:right">$20-30k</th>
<th style="text-align:right">$30-40k</th>
<th style="text-align:right">$40-50k</th>
<th style="text-align:right">$50-75k</th>
<th style="text-align:right">$75-100k</th>
<th style="text-align:right">$100-150k</th>
<th style="text-align:right">&gt;150k</th>
<th style="text-align:right">Don&apos;t know/refused</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Agnostic</td>
<td style="text-align:right">27</td>
<td style="text-align:right">34</td>
<td style="text-align:right">60</td>
<td style="text-align:right">81</td>
<td style="text-align:right">76</td>
<td style="text-align:right">137</td>
<td style="text-align:right">122</td>
<td style="text-align:right">109</td>
<td style="text-align:right">84</td>
<td style="text-align:right">96</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Atheist</td>
<td style="text-align:right">12</td>
<td style="text-align:right">27</td>
<td style="text-align:right">37</td>
<td style="text-align:right">52</td>
<td style="text-align:right">35</td>
<td style="text-align:right">70</td>
<td style="text-align:right">73</td>
<td style="text-align:right">59</td>
<td style="text-align:right">74</td>
<td style="text-align:right">76</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Buddhist</td>
<td style="text-align:right">27</td>
<td style="text-align:right">21</td>
<td style="text-align:right">30</td>
<td style="text-align:right">34</td>
<td style="text-align:right">33</td>
<td style="text-align:right">58</td>
<td style="text-align:right">62</td>
<td style="text-align:right">39</td>
<td style="text-align:right">53</td>
<td style="text-align:right">54</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Catholic</td>
<td style="text-align:right">418</td>
<td style="text-align:right">617</td>
<td style="text-align:right">732</td>
<td style="text-align:right">670</td>
<td style="text-align:right">638</td>
<td style="text-align:right">1116</td>
<td style="text-align:right">949</td>
<td style="text-align:right">792</td>
<td style="text-align:right">633</td>
<td style="text-align:right">1489</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Don&#x2019;t know/refused</td>
<td style="text-align:right">15</td>
<td style="text-align:right">14</td>
<td style="text-align:right">15</td>
<td style="text-align:right">11</td>
<td style="text-align:right">10</td>
<td style="text-align:right">35</td>
<td style="text-align:right">21</td>
<td style="text-align:right">17</td>
<td style="text-align:right">18</td>
<td style="text-align:right">116</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li><p>&#x5BF9;&#x4E8E;&#x5C55;&#x793A;&#x6570;&#x636E;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x79CD;&quot;&#x5BBD;&quot;&#x6570;&#x636E;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#xFF0C;&#x5982;&#x7B2C;&#x4E00;&#x884C;&#x6570;&#x636E;&#xFF0C;&#x5C55;&#x793A;&#x4E86;Agnostic&#xFF08;&#x4E0D;&#x53EF;&#x77E5;&#x8BBA;&#xFF08;&#x8005;&#xFF09;&#xFF09;&#x6240;&#x6709;&#x7684;&#x6536;&#x5165;&#x5206;&#x5E03;&#x60C5;&#x51B5;</p>
</li>
<li><p>&#x4ECE;&#x6570;&#x636E;&#x5206;&#x6790;&#x7684;&#x89D2;&#x5EA6;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x628A;&#x6570;&#x636E;&#x7531;&quot;&#x5BBD;&quot;&#x6570;&#x636E;&#xFF0C;&#x8F6C;&#x6362;&#x6210;&#x201D;&#x957F;&#x201D;&#x6570;&#x636E;</p>
</li>
<li><p>pandas&#x7684;melt&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x628A;&#x5BBD;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x8F6C;&#x6362;&#x4E3A;&#x957F;&#x6570;&#x636E;&#x96C6;</p>
<ul>
<li>melt&#x5373;&#x662F;&#x7C7B;&#x51FD;&#x6570;&#x4E5F;&#x662F;&#x5B9E;&#x4F8B;&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x65E2;&#x53EF;&#x4EE5;&#x7528;pd.melt, &#x4E5F;&#x53EF;&#x4F7F;&#x7528;dataframe.melt()</li>
</ul>
<p>| &#x53C2;&#x6570;       | &#x7C7B;&#x578B;               | &#x8BF4;&#x660E;                                                         |
| ---------- | ------------------ | ------------------------------------------------------------ |
| frame      | dataframe          | &#x88AB; melt &#x7684;&#x6570;&#x636E;&#x96C6;&#x540D;&#x79F0;&#x5728; pd.melt() &#x4E2D;&#x4F7F;&#x7528;                      |
| id_vars    | tuple/list/ndarray | &#x53EF;&#x9009;&#x9879;<strong>&#x4E0D;&#x9700;&#x8981;&#x88AB;&#x8F6C;&#x6362;&#x7684;&#x5217;&#x540D;</strong>&#xFF0C;&#x5728;&#x8F6C;&#x6362;&#x540E;&#x4F5C;&#x4E3A;&#x6807;&#x8BC6;&#x7B26;&#x5217;&#xFF08;&#x4E0D;&#x662F;&#x7D22;&#x5F15;&#x5217;&#xFF09; |
| value_vars | tuple/list/ndarray | &#x53EF;&#x9009;&#x9879;<strong>&#x9700;&#x8981;&#x88AB;&#x8F6C;&#x6362;&#x7684;&#x73B0;&#x6709;&#x5217;</strong>&#x5982;&#x679C;&#x672A;&#x6307;&#x660E;&#xFF0C;&#x9664; id_vars &#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#x5217;&#x90FD;&#x88AB;&#x8F6C;&#x6362; |
| var_name   | string             | variable &#x9ED8;&#x8BA4;&#x503C;&#x81EA;&#x5B9A;&#x4E49;&#x5217;&#x540D;&#x540D;&#x79F0;<strong>&#x8BBE;&#x7F6E;&#x7531; &apos;value_vars&apos; &#x7EC4;&#x6210;&#x7684;&#x65B0;&#x7684; column name</strong> |
| value_name | string             | value &#x9ED8;&#x8BA4;&#x503C;&#x81EA;&#x5B9A;&#x4E49;&#x5217;&#x540D;&#x540D;&#x79F0;<strong>&#x8BBE;&#x7F6E;&#x7531; &apos;value_vars&apos; &#x7684;&#x6570;&#x636E;&#x7EC4;&#x6210;&#x7684;&#x65B0;&#x7684; column name</strong> |
| col_level  | int/string         | &#x53EF;&#x9009;&#x9879;&#x5982;&#x679C;&#x5217;&#x662F;MultiIndex&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x6B64;&#x7EA7;&#x522B;                       |</p>
<ul>
<li>&#x4F7F;&#x7528;melt&#x5BF9;&#x4E0A;&#x9762;&#x7684;pew&#x6570;&#x636E;&#x96C6;&#x8FDB;&#x884C;&#x5904;&#x7406;</li>
</ul>
<pre><code class="lang-python">pew_long = pd.melt(pew,id_vars=<span class="hljs-string">&apos;religion&apos;</span>)
pew_long
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<p>|      |              religion |           variable | value |
| ---: | --------------------: | -----------------: | ----: |
|    0 |              Agnostic |              &lt;$10k |    27 |
|    1 |               Atheist |              &lt;$10k |    12 |
|    2 |              Buddhist |              &lt;$10k |    27 |
|    3 |              Catholic |              &lt;$10k |   418 |
|    4 |    Don&#x2019;t know/refused |              &lt;$10k |    15 |
|  ... |                   ... |                ... |   ... |
|  175 |              Orthodox | Don&apos;t know/refused |    73 |
|  176 |       Other Christian | Don&apos;t know/refused |    18 |
|  177 |          Other Faiths | Don&apos;t know/refused |    71 |
|  178 | Other World Religions | Don&apos;t know/refused |     8 |
|  179 |          Unaffiliated | Don&apos;t know/refused |   597 |</p>
<p>180 rows &#xD7; 3 columns</p>
<ul>
<li>&#x53EF;&#x4EE5;&#x66F4;&#x6539;melt&#x4E4B;&#x540E;&#x7684;&#x6570;&#x636E;&#x7684;&#x5217;&#x540D;</li>
</ul>
</blockquote>
<pre><code class="lang-python">pew_long = pd.melt(pew,id_vars=<span class="hljs-string">&apos;religion&apos;</span>,var_name=<span class="hljs-string">&apos;income&apos;</span>,value_name=<span class="hljs-string">&apos;count&apos;</span>)
pew_long
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<p>|      |              religion |             income | count |
| ---: | --------------------: | -----------------: | ----: |
|    0 |              Agnostic |              &lt;$10k |    27 |
|    1 |               Atheist |              &lt;$10k |    12 |
|    2 |              Buddhist |              &lt;$10k |    27 |
|    3 |              Catholic |              &lt;$10k |   418 |
|    4 |    Don&#x2019;t know/refused |              &lt;$10k |    15 |
|  ... |                   ... |                ... |   ... |
|  175 |              Orthodox | Don&apos;t know/refused |    73 |
|  176 |       Other Christian | Don&apos;t know/refused |    18 |
|  177 |          Other Faiths | Don&apos;t know/refused |    71 |
|  178 | Other World Religions | Don&apos;t know/refused |     8 |
|  179 |          Unaffiliated | Don&apos;t know/refused |   597 |</p>
<p>180 rows &#xD7; 3 columns</p>
</blockquote>
</li>
<li><p>&#x5728;&#x4F7F;&#x7528;melt&#x51FD;&#x6570;&#x8F6C;&#x6362;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x56FA;&#x5B9A;&#x591A;&#x6570;&#x5217;&#xFF0C;&#x53EA;&#x8F6C;&#x6362;&#x5C11;&#x6570;&#x5217;</p>
</li>
</ul>
<pre><code class="lang-python">bill_board = pd.read_csv(<span class="hljs-string">&apos;data/billboard.csv&apos;</span>)
bill_board
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th style="text-align:right">date.entered</th>
<th style="text-align:right">wk1</th>
<th style="text-align:right">wk2</th>
<th style="text-align:right">wk3</th>
<th style="text-align:right">wk4</th>
<th style="text-align:right">wk5</th>
<th style="text-align:right">...</th>
<th style="text-align:right">wk67</th>
<th style="text-align:right">wk68</th>
<th style="text-align:right">wk69</th>
<th style="text-align:right">wk70</th>
<th style="text-align:right">wk71</th>
<th style="text-align:right">wk72</th>
<th style="text-align:right">wk73</th>
<th style="text-align:right">wk74</th>
<th style="text-align:right">wk75</th>
<th>wk76</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">87</td>
<td style="text-align:right">82.0</td>
<td style="text-align:right">72.0</td>
<td style="text-align:right">77.0</td>
<td style="text-align:right">87.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2Ge+her</td>
<td style="text-align:right">The Hardest Part Of ...</td>
<td style="text-align:right">3:15</td>
<td style="text-align:right">2000-09-02</td>
<td style="text-align:right">91</td>
<td style="text-align:right">87.0</td>
<td style="text-align:right">92.0</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Kryptonite</td>
<td style="text-align:right">3:53</td>
<td style="text-align:right">2000-04-08</td>
<td style="text-align:right">81</td>
<td style="text-align:right">70.0</td>
<td style="text-align:right">68.0</td>
<td style="text-align:right">67.0</td>
<td style="text-align:right">66.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">76</td>
<td style="text-align:right">76.0</td>
<td style="text-align:right">72.0</td>
<td style="text-align:right">69.0</td>
<td style="text-align:right">67.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">504 Boyz</td>
<td style="text-align:right">Wobble Wobble</td>
<td style="text-align:right">3:35</td>
<td style="text-align:right">2000-04-15</td>
<td style="text-align:right">57</td>
<td style="text-align:right">34.0</td>
<td style="text-align:right">25.0</td>
<td style="text-align:right">17.0</td>
<td style="text-align:right">17.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">312</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yankee Grey</td>
<td style="text-align:right">Another Nine Minutes</td>
<td style="text-align:right">3:10</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">86</td>
<td style="text-align:right">83.0</td>
<td style="text-align:right">77.0</td>
<td style="text-align:right">74.0</td>
<td style="text-align:right">83.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">313</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yearwood, Trisha</td>
<td style="text-align:right">Real Live Woman</td>
<td style="text-align:right">3:55</td>
<td style="text-align:right">2000-04-01</td>
<td style="text-align:right">85</td>
<td style="text-align:right">83.0</td>
<td style="text-align:right">83.0</td>
<td style="text-align:right">82.0</td>
<td style="text-align:right">81.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">314</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Ying Yang Twins</td>
<td style="text-align:right">Whistle While You Tw...</td>
<td style="text-align:right">4:19</td>
<td style="text-align:right">2000-03-18</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94.0</td>
<td style="text-align:right">91.0</td>
<td style="text-align:right">85.0</td>
<td style="text-align:right">84.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">315</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Zombie Nation</td>
<td style="text-align:right">Kernkraft 400</td>
<td style="text-align:right">3:30</td>
<td style="text-align:right">2000-09-02</td>
<td style="text-align:right">99</td>
<td style="text-align:right">99.0</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">316</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">60</td>
<td style="text-align:right">37.0</td>
<td style="text-align:right">29.0</td>
<td style="text-align:right">24.0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">...</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>317 rows &#xD7; 81 columns</p>
</blockquote>
<ul>
<li>&#x4F7F;&#x7528;melt &#x5BF9;&#x4E0A;&#x9762;&#x6570;&#x636E;&#x7684;week&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x8F6C;&#x6362;&#x6210;&#x957F;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-python">bill_borad_long = pd.melt(bill_board,id_vars=[<span class="hljs-string">&apos;year&apos;</span>,<span class="hljs-string">&apos;artist&apos;</span>,<span class="hljs-string">&apos;track&apos;</span>,<span class="hljs-string">&apos;time&apos;</span>,<span class="hljs-string">&apos;date.entered&apos;</span>],
                          var_name=<span class="hljs-string">&apos;week&apos;</span>,value_name=<span class="hljs-string">&apos;rating&apos;</span>)
bill_borad_long
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th style="text-align:right">date.entered</th>
<th style="text-align:right">week</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">wk1</td>
<td>87.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2Ge+her</td>
<td style="text-align:right">The Hardest Part Of ...</td>
<td style="text-align:right">3:15</td>
<td style="text-align:right">2000-09-02</td>
<td style="text-align:right">wk1</td>
<td>91.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Kryptonite</td>
<td style="text-align:right">3:53</td>
<td style="text-align:right">2000-04-08</td>
<td style="text-align:right">wk1</td>
<td>81.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk1</td>
<td>76.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">504 Boyz</td>
<td style="text-align:right">Wobble Wobble</td>
<td style="text-align:right">3:35</td>
<td style="text-align:right">2000-04-15</td>
<td style="text-align:right">wk1</td>
<td>57.0</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">24087</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yankee Grey</td>
<td style="text-align:right">Another Nine Minutes</td>
<td style="text-align:right">3:10</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24088</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yearwood, Trisha</td>
<td style="text-align:right">Real Live Woman</td>
<td style="text-align:right">3:55</td>
<td style="text-align:right">2000-04-01</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24089</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Ying Yang Twins</td>
<td style="text-align:right">Whistle While You Tw...</td>
<td style="text-align:right">4:19</td>
<td style="text-align:right">2000-03-18</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24090</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Zombie Nation</td>
<td style="text-align:right">Kernkraft 400</td>
<td style="text-align:right">3:30</td>
<td style="text-align:right">2000-09-02</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24091</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>24092 rows &#xD7; 7 columns</p>
</blockquote>
<ul>
<li>&#x53EF;&#x4EE5;&#x5C06;&#x4E0A;&#x8FF0;&#x6570;&#x636E;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x67E5;&#x8BE2;&#x4EFB;&#x610F;&#x4E00;&#x9996;&#x6B4C;&#x66F2;&#x4FE1;&#x606F;&#x65F6;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#x6709;&#x5197;&#x4F59;&#x7684;&#x60C5;&#x51B5;</li>
</ul>
<pre><code class="lang-python">bill_borad_long[bill_borad_long.track ==<span class="hljs-string">&apos;Loser&apos;</span>]
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th style="text-align:right">date.entered</th>
<th style="text-align:right">week</th>
<th style="text-align:right">rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk1</td>
<td style="text-align:right">76.0</td>
</tr>
<tr>
<td style="text-align:right">320</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk2</td>
<td style="text-align:right">76.0</td>
</tr>
<tr>
<td style="text-align:right">637</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk3</td>
<td style="text-align:right">72.0</td>
</tr>
<tr>
<td style="text-align:right">954</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk4</td>
<td style="text-align:right">69.0</td>
</tr>
<tr>
<td style="text-align:right">1271</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk5</td>
<td style="text-align:right">67.0</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
</tr>
<tr>
<td style="text-align:right">22510</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk72</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">22827</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk73</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">23144</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk74</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">23461</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk75</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">23778</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td style="text-align:right">wk76</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>76 rows &#xD7; 7 columns</p>
</blockquote>
<ul>
<li>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x6570;&#x636E;&#x5305;&#x542B;&#x4E86;&#x4E24;&#x7C7B;&#x6570;&#x636E;&#xFF1A;&#x6B4C;&#x66F2;&#x4FE1;&#x606F;&#x3001;&#x5468;&#x6392;&#x884C;&#x4FE1;&#x606F;<ul>
<li>&#x5BF9;&#x4E8E;&#x540C;&#x4E00;&#x9996;&#x6B4C;&#x66F2;&#x6765;&#x8BF4;&#xFF0C;&#x6B4C;&#x66F2;&#x4FE1;&#x606F;&#x662F;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5355;&#x72EC;&#x4FDD;&#x5B58;&#x6B4C;&#x66F2;&#x4FE1;&#x606F;</li>
<li>&#x51CF;&#x5C11;&#x4E0A;&#x8868;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x6B4C;&#x66F2;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF0C;&#x9700;&#x8981;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;merge&#x62FC;&#x63A5;&#x6570;&#x636E;</li>
<li>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;year,artist,track,time&#x548C;date.entered&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;dataframe&#x4E2D;</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">billboard_songs = bill_borad_long[[<span class="hljs-string">&apos;year&apos;</span>,<span class="hljs-string">&apos;artist&apos;</span>,<span class="hljs-string">&apos;track&apos;</span>,<span class="hljs-string">&apos;time&apos;</span>,<span class="hljs-string">&apos;date.entered&apos;</span>]]
billboard_songs = billboard_songs.drop_duplicates()
billboard_songs
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th>date.entered</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td>2000-02-26</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2Ge+her</td>
<td style="text-align:right">The Hardest Part Of ...</td>
<td style="text-align:right">3:15</td>
<td>2000-09-02</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Kryptonite</td>
<td style="text-align:right">3:53</td>
<td>2000-04-08</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td>2000-10-21</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">504 Boyz</td>
<td style="text-align:right">Wobble Wobble</td>
<td style="text-align:right">3:35</td>
<td>2000-04-15</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">312</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yankee Grey</td>
<td style="text-align:right">Another Nine Minutes</td>
<td style="text-align:right">3:10</td>
<td>2000-04-29</td>
</tr>
<tr>
<td style="text-align:right">313</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yearwood, Trisha</td>
<td style="text-align:right">Real Live Woman</td>
<td style="text-align:right">3:55</td>
<td>2000-04-01</td>
</tr>
<tr>
<td style="text-align:right">314</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Ying Yang Twins</td>
<td style="text-align:right">Whistle While You Tw...</td>
<td style="text-align:right">4:19</td>
<td>2000-03-18</td>
</tr>
<tr>
<td style="text-align:right">315</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Zombie Nation</td>
<td style="text-align:right">Kernkraft 400</td>
<td style="text-align:right">3:30</td>
<td>2000-09-02</td>
</tr>
<tr>
<td style="text-align:right">316</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td>2000-04-29</td>
</tr>
</tbody>
</table>
<p>317 rows &#xD7; 5 columns</p>
</blockquote>
<ul>
<li>&#x4E3A;&#x4E0A;&#x9762;&#x6570;&#x636E;&#x6DFB;&#x52A0;id&#x5217;</li>
</ul>
<pre><code class="lang-python">billboard_songs[<span class="hljs-string">&apos;id&apos;</span>] = range(len(billboard_songs))
billboard_songs
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th style="text-align:right">date.entered</th>
<th>id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td>0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2Ge+her</td>
<td style="text-align:right">The Hardest Part Of ...</td>
<td style="text-align:right">3:15</td>
<td style="text-align:right">2000-09-02</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Kryptonite</td>
<td style="text-align:right">3:53</td>
<td style="text-align:right">2000-04-08</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">3 Doors Down</td>
<td style="text-align:right">Loser</td>
<td style="text-align:right">4:24</td>
<td style="text-align:right">2000-10-21</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">504 Boyz</td>
<td style="text-align:right">Wobble Wobble</td>
<td style="text-align:right">3:35</td>
<td style="text-align:right">2000-04-15</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">312</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yankee Grey</td>
<td style="text-align:right">Another Nine Minutes</td>
<td style="text-align:right">3:10</td>
<td style="text-align:right">2000-04-29</td>
<td>312</td>
</tr>
<tr>
<td style="text-align:right">313</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Yearwood, Trisha</td>
<td style="text-align:right">Real Live Woman</td>
<td style="text-align:right">3:55</td>
<td style="text-align:right">2000-04-01</td>
<td>313</td>
</tr>
<tr>
<td style="text-align:right">314</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Ying Yang Twins</td>
<td style="text-align:right">Whistle While You Tw...</td>
<td style="text-align:right">4:19</td>
<td style="text-align:right">2000-03-18</td>
<td>314</td>
</tr>
<tr>
<td style="text-align:right">315</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">Zombie Nation</td>
<td style="text-align:right">Kernkraft 400</td>
<td style="text-align:right">3:30</td>
<td style="text-align:right">2000-09-02</td>
<td>315</td>
</tr>
<tr>
<td style="text-align:right">316</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td>316</td>
</tr>
</tbody>
</table>
<p>317 rows &#xD7; 6 columns</p>
</blockquote>
<ul>
<li>&#x5C06;id&#x5217;&#x5173;&#x8054;&#x5230;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x5F97;&#x5230;&#x5305;&#x542B;id&#x7684;&#x5B8C;&#x6574;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x4ECE;&#x5B8C;&#x6574;&#x6570;&#x636E;&#x4E2D;&#xFF0C;&#x53D6;&#x51FA;&#x6BCF;&#x5468;&#x8BC4;&#x5206;&#x90E8;&#x5206;&#xFF0C;&#x53BB;&#x6389;&#x5197;&#x4F59;&#x4FE1;&#x606F;</li>
</ul>
<pre><code class="lang-python">billboard_ratings = bill_borad_long.merge(billboard_songs,on=[<span class="hljs-string">&apos;year&apos;</span>,<span class="hljs-string">&apos;artist&apos;</span>,<span class="hljs-string">&apos;track&apos;</span>,<span class="hljs-string">&apos;time&apos;</span>,<span class="hljs-string">&apos;date.entered&apos;</span>])
billboard_ratings = billboard_ratings[[<span class="hljs-string">&apos;id&apos;</span>,<span class="hljs-string">&apos;week&apos;</span>,<span class="hljs-string">&apos;rating&apos;</span>]]
billboard_ratings
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">week</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk1</td>
<td>87.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk2</td>
<td>82.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk3</td>
<td>72.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk4</td>
<td>77.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk5</td>
<td>87.0</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">24087</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk72</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24088</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk73</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24089</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk74</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24090</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk75</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24091</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>24092 rows &#xD7; 3 columns</p>
</blockquote>
<ul>
<li>&#x8FD9;&#x6837;&#xFF0C;&#x6570;&#x636E;&#x62C6;&#x5206;&#x6210;&#x4E24;&#x4E2A;dataframe&#xFF1A;billboard_songs&#x548C; billboard_ratings&#xFF0C;&#x4FDD;&#x5B58;&#x6210;&#x6587;&#x4EF6;&#x540E;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x78C1;&#x76D8;&#x5F00;&#x9500;&#xFF0C;&#x52A0;&#x8F7D;&#x65F6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;merge&#x518D;&#x8FD8;&#x539F;&#x6210;&#x539F;&#x59CB;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-python">billboard_songs.merge(billboard_ratings,on=[<span class="hljs-string">&apos;id&apos;</span>])
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">year</th>
<th style="text-align:right">artist</th>
<th style="text-align:right">track</th>
<th style="text-align:right">time</th>
<th style="text-align:right">date.entered</th>
<th style="text-align:right">id</th>
<th style="text-align:right">week</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk1</td>
<td>87.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk2</td>
<td>82.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk3</td>
<td>72.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk4</td>
<td>77.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">2 Pac</td>
<td style="text-align:right">Baby Don&apos;t Cry (Keep...</td>
<td style="text-align:right">4:22</td>
<td style="text-align:right">2000-02-26</td>
<td style="text-align:right">0</td>
<td style="text-align:right">wk5</td>
<td>87.0</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
<td>...</td>
</tr>
<tr>
<td style="text-align:right">24087</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk72</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24088</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk73</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24089</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk74</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24090</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk75</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">24091</td>
<td style="text-align:right">2000</td>
<td style="text-align:right">matchbox twenty</td>
<td style="text-align:right">Bent</td>
<td style="text-align:right">4:12</td>
<td style="text-align:right">2000-04-29</td>
<td style="text-align:right">316</td>
<td style="text-align:right">wk76</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>24092 rows &#xD7; 8 columns</p>
</blockquote>
<h2 id="2-stack&#x6574;&#x7406;&#x6570;&#x636E;">2 stack&#x6574;&#x7406;&#x6570;&#x636E;</h2>
<ul>
<li>&#x52A0;&#x8F7D;state_fruit&#x6570;&#x636E;&#x96C6;</li>
</ul>
<pre><code class="lang-python">state_fruit = pd.read_csv(<span class="hljs-string">&apos;data/state_fruit.csv&apos;</span>, index_col=<span class="hljs-number">0</span>)
state_fruit
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Apple</th>
<th style="text-align:right">Orange</th>
<th style="text-align:right">Banana</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Texas</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">9</td>
<td style="text-align:right">7</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">Florida</td>
<td style="text-align:right">0</td>
<td style="text-align:right">14</td>
<td style="text-align:right">190</td>
</tr>
</tbody>
</table>
</blockquote>
<pre><code class="lang-python">state_fruit.stack()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<pre><code class="lang-shell">Texas    Apple      12
        Orange     10
        Banana     40
Arizona  Apple       9
        Orange      7
        Banana     12
Florida  Apple       0
        Orange     14
        Banana    190
dtype: int64
</code></pre>
</blockquote>
<ul>
<li>&#x4F7F;&#x7528;reset_index()&#xFF0C;&#x5C06;&#x7ED3;&#x679C;&#x53D8;&#x4E3A;DataFrame</li>
</ul>
<pre><code class="lang-python">state_fruit_tidy = state_fruit.stack().reset_index()
state_fruit_tidy
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">level_0</th>
<th style="text-align:right">level_1</th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Apple</td>
<td>12</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Orange</td>
<td>10</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Banana</td>
<td>40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Apple</td>
<td>9</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Orange</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Banana</td>
<td>12</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Apple</td>
<td>0</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Orange</td>
<td>14</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Banana</td>
<td>190</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>&#x91CD;&#x547D;&#x540D;&#x5217;</li>
</ul>
<pre><code class="lang-python">state_fruit_tidy.columns = [<span class="hljs-string">&apos;state&apos;</span>, <span class="hljs-string">&apos;fruit&apos;</span>, <span class="hljs-string">&apos;weight&apos;</span>]
state_fruit_tidy
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">state</th>
<th style="text-align:right">fruit</th>
<th>weight</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Apple</td>
<td>12</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Orange</td>
<td>10</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Banana</td>
<td>40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Apple</td>
<td>9</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Orange</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Banana</td>
<td>12</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Apple</td>
<td>0</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Orange</td>
<td>14</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Banana</td>
<td>190</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;rename_axis&#x7ED9;&#x4E0D;&#x540C;&#x7684;&#x884C;&#x7D22;&#x5F15;&#x5C42;&#x7EA7;&#x547D;&#x540D;</li>
</ul>
<pre><code class="lang-python">state_fruit.stack().rename_axis([<span class="hljs-string">&apos;state&apos;</span>, <span class="hljs-string">&apos;fruit&apos;</span>])
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<pre><code class="lang-shell">state    fruit 
Texas    Apple      12
        Orange     10
        Banana     40
Arizona  Apple       9
        Orange      7
        Banana     12
Florida  Apple       0
        Orange     14
        Banana    190
dtype: int64
</code></pre>
</blockquote>
<ul>
<li>&#x518D;&#x6B21;&#x4F7F;&#x7528;reset_index&#x65B9;&#x6CD5;</li>
</ul>
<pre><code class="lang-python">state_fruit.stack().rename_axis([<span class="hljs-string">&apos;state&apos;</span>, <span class="hljs-string">&apos;fruit&apos;</span>]).reset_index(name=<span class="hljs-string">&apos;weight&apos;</span>)
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">state</th>
<th style="text-align:right">fruit</th>
<th style="text-align:right">weight</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Apple</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Orange</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Texas</td>
<td style="text-align:right">Banana</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Apple</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Orange</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">Banana</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Apple</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Orange</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">Florida</td>
<td style="text-align:right">Banana</td>
<td style="text-align:right">190</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="3-widetolong&#x6574;&#x7406;&#x6570;&#x636E;">3 wide_to_long&#x6574;&#x7406;&#x6570;&#x636E;</h2>
<ul>
<li>&#x52A0;&#x8F7D;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-python">movie = pd.read_csv(<span class="hljs-string">&apos;data/movie.csv&apos;</span>)
actor = movie[[<span class="hljs-string">&apos;movie_title&apos;</span>, <span class="hljs-string">&apos;actor_1_name&apos;</span>, <span class="hljs-string">&apos;actor_2_name&apos;</span>, <span class="hljs-string">&apos;actor_3_name&apos;</span>, 
               <span class="hljs-string">&apos;actor_1_facebook_likes&apos;</span>, <span class="hljs-string">&apos;actor_2_facebook_likes&apos;</span>, <span class="hljs-string">&apos;actor_3_facebook_likes&apos;</span>]]
actor.head()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">movie_title</th>
<th style="text-align:right">actor_1_name</th>
<th style="text-align:right">actor_2_name</th>
<th style="text-align:right">actor_3_name</th>
<th style="text-align:right">actor_1_facebook_likes</th>
<th style="text-align:right">actor_2_facebook_likes</th>
<th style="text-align:right">actor_3_facebook_likes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Avatar</td>
<td style="text-align:right">CCH Pounder</td>
<td style="text-align:right">Joel David Moore</td>
<td style="text-align:right">Wes Studi</td>
<td style="text-align:right">1000.0</td>
<td style="text-align:right">936.0</td>
<td style="text-align:right">855.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pirates of the Caribbean: At World&apos;s End</td>
<td style="text-align:right">Johnny Depp</td>
<td style="text-align:right">Orlando Bloom</td>
<td style="text-align:right">Jack Davenport</td>
<td style="text-align:right">40000.0</td>
<td style="text-align:right">5000.0</td>
<td style="text-align:right">1000.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Spectre</td>
<td style="text-align:right">Christoph Waltz</td>
<td style="text-align:right">Rory Kinnear</td>
<td style="text-align:right">Stephanie Sigman</td>
<td style="text-align:right">11000.0</td>
<td style="text-align:right">393.0</td>
<td style="text-align:right">161.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">The Dark Knight Rises</td>
<td style="text-align:right">Tom Hardy</td>
<td style="text-align:right">Christian Bale</td>
<td style="text-align:right">Joseph Gordon-Levitt</td>
<td style="text-align:right">27000.0</td>
<td style="text-align:right">23000.0</td>
<td style="text-align:right">23000.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align:right">Doug Walker</td>
<td style="text-align:right">Rob Walker</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">131.0</td>
<td style="text-align:right">12.0</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>&#x4ECE;&#x4E0A;&#x9762;&#x6570;&#x636E;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5217;&#x540D;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x6570;&#x5B57; 1,2,3 &#x5982;&#x679C;&#x60F3;&#x628A;&#x8FD9;&#x90E8;&#x5206;&#x4FE1;&#x606F;&#x63D0;&#x53D6;&#x5230;&#x5217;&#x5F53;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;wide_to_long&#x51FD;&#x6570;</li>
<li>&#x4F7F;&#x7528;wide_to_long&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x8981;&#x6C42; 1,2,3 &#x8FD9;&#x6837;&#x7684;&#x987A;&#x5E8F;&#x4FE1;&#x606F;&#x5728;&#x5217;&#x540D;&#x7684;&#x6700;&#x540E;&#xFF0C;&#x5E76;&#x7528;&#x5206;&#x9694;&#x7B26;&#x9694;&#x5F00;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-comment">#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#xFF0C;&#x7528;&#x6765;&#x6539;&#x53D8;&#x5217;&#x540D;&#x3002;&#x5C06;&#x6570;&#x5B57;&#x653E;&#x5230;&#x5217;&#x540D;&#x7684;&#x6700;&#x540E;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_col_name</span><span class="hljs-params">(col_name)</span>:</span>
    col_name = col_name.replace(<span class="hljs-string">&apos;_name&apos;</span>, <span class="hljs-string">&apos;&apos;</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-string">&apos;facebook&apos;</span> <span class="hljs-keyword">in</span> col_name:
        fb_idx = col_name.find(<span class="hljs-string">&apos;facebook&apos;</span>)
        col_name = col_name[:<span class="hljs-number">5</span>] + col_name[fb_idx - <span class="hljs-number">1</span>:] + col_name[<span class="hljs-number">5</span>:fb_idx-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> col_name
actor2 = actor.rename(columns=change_col_name)
actor2.head()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">movie_title</th>
<th style="text-align:right">actor_1</th>
<th style="text-align:right">actor_2</th>
<th style="text-align:right">actor_3</th>
<th style="text-align:right">actor_facebook_likes_1</th>
<th style="text-align:right">actor_facebook_likes_2</th>
<th style="text-align:right">actor_facebook_likes_3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Avatar</td>
<td style="text-align:right">CCH Pounder</td>
<td style="text-align:right">Joel David Moore</td>
<td style="text-align:right">Wes Studi</td>
<td style="text-align:right">1000.0</td>
<td style="text-align:right">936.0</td>
<td style="text-align:right">855.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pirates of the Caribbean: At World&apos;s End</td>
<td style="text-align:right">Johnny Depp</td>
<td style="text-align:right">Orlando Bloom</td>
<td style="text-align:right">Jack Davenport</td>
<td style="text-align:right">40000.0</td>
<td style="text-align:right">5000.0</td>
<td style="text-align:right">1000.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Spectre</td>
<td style="text-align:right">Christoph Waltz</td>
<td style="text-align:right">Rory Kinnear</td>
<td style="text-align:right">Stephanie Sigman</td>
<td style="text-align:right">11000.0</td>
<td style="text-align:right">393.0</td>
<td style="text-align:right">161.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">The Dark Knight Rises</td>
<td style="text-align:right">Tom Hardy</td>
<td style="text-align:right">Christian Bale</td>
<td style="text-align:right">Joseph Gordon-Levitt</td>
<td style="text-align:right">27000.0</td>
<td style="text-align:right">23000.0</td>
<td style="text-align:right">23000.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align:right">Doug Walker</td>
<td style="text-align:right">Rob Walker</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">131.0</td>
<td style="text-align:right">12.0</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
</blockquote>
<pre><code class="lang-python">stubs = [<span class="hljs-string">&apos;actor&apos;</span>, <span class="hljs-string">&apos;actor_facebook_likes&apos;</span>]
actor2_tidy = pd.wide_to_long(actor2, 
                              stubnames=stubs, 
                              i=[<span class="hljs-string">&apos;movie_title&apos;</span>], 
                              j=<span class="hljs-string">&apos;actor_num&apos;</span>, 
                              sep=<span class="hljs-string">&apos;_&apos;</span>).reset_index()
actor2_tidy.head()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">movie_title</th>
<th style="text-align:right">actor_num</th>
<th style="text-align:right">actor</th>
<th style="text-align:right">actor_facebook_likes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Avatar</td>
<td style="text-align:right">1</td>
<td style="text-align:right">CCH Pounder</td>
<td style="text-align:right">1000.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pirates of the Caribbean: At World&apos;s End</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Johnny Depp</td>
<td style="text-align:right">40000.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Spectre</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Christoph Waltz</td>
<td style="text-align:right">11000.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">The Dark Knight Rises</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Tom Hardy</td>
<td style="text-align:right">27000.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Doug Walker</td>
<td style="text-align:right">131.0</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="4-unstack-&#x5904;&#x7406;&#x6570;&#x636E;">4 unstack &#x5904;&#x7406;&#x6570;&#x636E;</h2>
<ul>
<li>&#x4E4B;&#x524D;&#x4ECB;&#x7ECD;&#x4E86;stack&#xFF0C;unstack&#x53EF;&#x4EE5;&#x5C06;stack&#x7684;&#x7ED3;&#x679C;&#x6062;&#x590D;</li>
</ul>
<pre><code class="lang-python">state_fruit = pd.read_csv(<span class="hljs-string">&apos;data/state_fruit.csv&apos;</span>, index_col=<span class="hljs-number">0</span>)
state_fruit.stack()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<pre><code class="lang-shell">Texas    Apple      12
        Orange     10
        Banana     40
Arizona  Apple       9
        Orange      7
        Banana     12
Florida  Apple       0
        Orange     14
        Banana    190
dtype: int64
</code></pre>
</blockquote>
<pre><code class="lang-python">state_fruit.stack().unstack()
</code></pre>
<blockquote>
<font color="red">&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF1A;</font>

<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Apple</th>
<th style="text-align:right">Orange</th>
<th style="text-align:right">Banana</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Texas</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">Arizona</td>
<td style="text-align:right">9</td>
<td style="text-align:right">7</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">Florida</td>
<td style="text-align:right">0</td>
<td style="text-align:right">14</td>
<td style="text-align:right">190</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>melt&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x6709;&#x53CD;&#x5411;&#x64CD;&#x4F5C;&#xFF0C;melt&#x64CD;&#x4F5C;&#x5728;pandas&#x6587;&#x6863;&#x4E2D;&#x88AB;&#x79F0;&#x4E3A;&quot;unpivot&#x201D;, &#x4E0E;melt&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x4E3A;piovt_table&#xFF0C;&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x518D;&#x4ECB;&#x7ECD;</li>
</ul>
<h2 id="&#x5C0F;&#x7ED3;">&#x5C0F;&#x7ED3;</h2>
<ul>
<li>melt&#xFF0C;stack&#xFF0C;wide_to_long&#x51FD;&#x6570;&#x5747;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8BB2;&#x5BBD;&#x6570;&#x636E;&#x6574;&#x7406;&#x6210;&#x957F;&#x6570;&#x636E;<ul>
<li>melt&#xFF1A;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x5217;&#xFF0C;&#x5C06;&#x6307;&#x5B9A;&#x5217;&#x53D8;&#x6210;&#x957F;&#x6570;&#x636E;</li>
<li>stack&#xFF1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5177;&#x6709;&#x591A;&#x5C42;&#x7EA7;&#x7D22;&#x5F15;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x914D;&#x5408;reset_index&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5BBD;&#x6570;&#x636E;&#x53D8;&#x6210;&#x957F;&#x6570;&#x636E;</li>
<li>wide_to_long&#xFF1A;&#x5904;&#x7406;&#x5217;&#x540D;&#x5E26;&#x6570;&#x5B57;&#x540E;&#x7F00;&#x7684;&#x5BBD;&#x6570;&#x636E;</li>
</ul>
</li>
<li>stack/unstack, melt/pivot_table &#x4E92;&#x4E3A;&#x9006;&#x5411;&#x64CD;&#x4F5C; </li>
</ul>
<footer class="page-footer"><span class="copyright">&#xA9;2021.4 &#x539F;&#x6EE1; all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2021-02-03 12:18:50
</span></footer>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./07_缺失数据处理.html" class="navigation navigation-prev " aria-label="Previous page: 缺失数据处理"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./09_Pandas数据类型.html" class="navigation navigation-next " aria-label="Next page: Pandas数据类型"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-splitter/splitter.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-back-to-top-button/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-toc2/toc2.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"expandable-chapters-small":{},"toc2":{"addClass":true,"className":"toc"},"tbfed-pagefooter":{"copyright":"©2021.4 原满","modify_label":"该文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"splitter":{},"back-to-top-button":{},"chapter-fold":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
