# 3.2语音合成

## 3.2.1 介绍

百度语音合成技术能将用户输入的文字，转换成流畅自然的语音输出，并且可以支持语速、音调、音量、音频码率设置，打破传统文字式人机交互的方式，让人机沟通更自然。

## 3.2.2  SDK方式调用服务

语音合成也支持 REST API方式调用服务，但是SDK对其进行了包装，方便使用，所以直接介绍SDK方式。

* 注意事项
  * 合成文本长度必须小于1024字节，如果本文长度较长，可以采用多次请求的方式。切忌文本长度超过限制。
  * 语音合成不限制调用量，但是初始的QPS为100，如果默认配额不能满足您的业务需求，请从控制台中申请提高配额。

## 3.2.3 SDK API介绍

```python
AipSpeech.synthesis(text, lang='zh', ctp=1, options=None)
```

| 参数 | 类型   | 描述                                                         | 是否必须 |
| ---- | ------ | ------------------------------------------------------------ | -------- |
| text | String | 合成的文本，使用UTF-8编码， 请注意文本长度必须小于1024字节   | 是       |
| lang | String | 语言选择，目前只有中英文混合这一种语言，优先中文发音 | 是 |
| ctp	| Integer |  客户端类型选择，web端填写固定值1 | 是|
| cuid | String | 用户唯一标识，用来区分用户， 填写机器 MAC 地址或 IMEI 码，长度为60以内 | 否       |
| spd  | String | 语速，取值0-9，默认为5中语速                                 | 否       |
| pit  | String | 音调，取值0-9，默认为5中语调                                 | 否       |
| vol  | String | 音量，取值0-15，默认为5中音量                                | 否       |
| per  | String | 发音人选择, 0为女声，1为男声， 3为情感合成-度逍遥，4为情感合成-度丫丫，默认为普通女 | 否       |



** 错误返回格式 **

若请求错误，服务器将返回的JSON文本包含以下参数：

- **error_code**：错误码。
- **error_msg**：错误描述信息，帮助理解和解决发生的错误。

** 错误码 **

| 错误码 | 含义           |
| ------ | -------------- |
| 500    | 不支持的输入   |
| 501    | 输入参数不正确 |
| 502    | token验证失败  |
| 503    | 合成后端错误   |

## 3.2.4 语音合成案例

### 3.2.4.1 实现步骤

* 实例化AipSpeech

* 调用synthesis方法

### 3.2.4.2 代码

  实例化AipSpeech

```python
""" 你的 APPID AK SK """
APP_ID = '11473655'
API_KEY = 'SGbWA7P4hBXsKWCMt9Gg2ASB'
SECRET_KEY = 'd8kOxB4j08qD9bGRAmYdGCmIPXoNa4xZ'

syn_client = AipSpeech(APP_ID, API_KEY, SECRET_KEY)
```

调用合成函数

```python
options = {}
options['vol'] = 5
options['per'] = 4

result  = syn_client.synthesis('在阿根廷3:4法国的比赛中，姆巴佩攻入两球，并制造了法国首打破僵局的点球，他那场犹如天神下凡的表现，惊艳了整个足坛。', 'zh', 1, options)

# 识别正确返回语音二进制 错误则返回dict 参照下面错误码
if not isinstance(result, dict):
    with open('auido.mp3', 'wb') as f:
        f.write(result)
```

## 3.2.3 总结

目前本SDK的功能同REST API，需要联网调用http接口 。[REST API](http://ai.baidu.com/docs#/TTS-API/top) 仅支持最多512字（1024 字节)的音频合成，合成的文件格式为mp3。**没有其他额外功能。** 如果需要使用离线合成等其它功能，请使用Android或者iOS 合成 SDK .